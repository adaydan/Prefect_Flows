from prefect import flow
from prefect.deployments import Deployment
from prefect.filesystems import GitHub

@flow(log_prints=True)
def run_script():
    x = 'abcd'
    print(x)
    return x

if __name__ == "__main__":
    storage = GitHub(repository="https://github.com/adaydan/Prefect_Flows", path="test_run.py")
    
    Deployment.build_from_flow(
        flow=run_script,
        name="cloud_run_script",
        storage=storage,
        work_pool_name="Adaydan Agent"
    ).apply()
